<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        font-family: Arial, sans-serif;
        background-color: #000;
      }

      .results-container {
        width: 1425px;
        background-color: #333;
        color: white;
        border-radius: 8px;
        overflow: hidden;
        opacity: 0.9;
      }

      .header {
        background-color: #8B1A1A;
        padding: 20px;
        text-align: center;
      }

      .header h1 {
        margin: 0;
        font-size: 2.5em;
      }

      .header h2 {
        margin: 10px 0 0 0;
        font-size: 2em;
      }

      .unofficial {
        text-align: right;
        padding: 10px;
        font-size: 1.5em;
      }

      .event-title {
        background-color: #444;
        padding: 10px;
        font-size: 1.8em;
        color: #90EE90;
      }

      .results-table {
        width: 100%;
        border-collapse: collapse;
      }

      .results-table tr {
        background-color: #4a4a4a;
        border-bottom: 1px solid #666;
      }

      .results-table tr:nth-child(even) {
        background-color: #3a3a3a;
      }

      .results-table td {
        padding: 15px;
        font-size: 1.5em;
      }

      .position {
        width: 5%;
      }

      .name {
        width: 50%;
        font-weight: bold;
      }

      .province {
        width: 15%;
      }

      .color-indicator {
        width: 10%;
      }

      .time {
        width: 20%;
        text-align: right;
      }

      .color-box {
        width: 20px;
        height: 20px;
        display: inline-block;
      }

      .yellow { background-color: yellow; }
      .blue { background-color: #0088ff; }
      .black { background-color: black; }
      .gray { background-color: gray; }
      .pink { background-color: #ff69b4; }
      .navy { background-color: navy; }
      .red { background-color: red; }
      .white { background-color: white; }
    </style>
  </head>
  <body>
    <div class="results-container">
      <div class="header">
        <h1 id="event-title"></h1>
        <h2 id="event-subtitle"></h2>
      </div>
      <div class="unofficial" id="event-status"></div>
      <div class="event-title" id="heat-name"></div>
      <table class="results-table" id="results-table">
        <tbody id="results-body">
          <!-- Results will be dynamically inserted here -->
        </tbody>
      </table>
    </div>

    <script>
      function updateDisplay(data) {
        // Update event information
        document.getElementById('event-title').textContent = data.event.title;
        document.getElementById('event-subtitle').textContent = data.event.subtitle;
        document.getElementById('event-status').textContent = data.event.status;
        document.getElementById('heat-name').textContent = data.event.heat;
        
        // Update results table
        const tbody = document.getElementById('results-body');
        tbody.innerHTML = ''; // Clear existing rows
        
        data.results.forEach(result => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td class="position">${result.position}</td>
            <td class="name">${result.name}</td>
            <td class="province">${result.province}</td>
            <td class="color-indicator"><div class="color-box ${result.color}"></div></td>
            <td class="time">${result.time}</td>
          `;
          tbody.appendChild(row);
        });
      }

      function loadScript() {
        return new Promise((resolve, reject) => {
          const oldScript = document.getElementById('race-data-script');
          if (oldScript) {
            oldScript.remove();
          }

          const script = document.createElement('script');
          script.id = 'race-data-script';
          script.src = `race-data.js?v=${Date.now()}`; // Add timestamp to prevent caching
          script.onload = () => {
            // Once the script is loaded, update the display with the new data
            if (window.raceData) {
              updateDisplay(window.raceData);
            }
            resolve();
          };
          script.onerror = reject;
          document.body.appendChild(script);
        });
      }

      async function updateData() {
        try {
          await loadScript();
        } catch (error) {
          console.error('Error loading race data:', error);
        }
      }

      // Initial load
      updateData();

      // Update every 200ms
      setInterval(updateData, 200);
    </script>
  </body>
</html>

